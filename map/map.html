<html><head>
    <script src="https://d3js.org/d3.v7.min.js"></script> 
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    
    <style>
      .state {
        stroke: white;
        stroke-width: 1px;
        fill: lightgray;
      }
      .outline
       {
        stroke: darkgray;
        stroke-width: 3px;
        fill: rgba(255, 255, 255, 0);
      }  
      </style>
  </head>
  
  <body>
    
    <p >
      <svg id="choropleth" height="770" width="990" style="margin:20px"></svg>
  
    <script>
      const svg = d3.select("#choropleth");
      const width = svg.attr("width");
      const height = svg.attr("height");
      const margin = { top: 20, right: 20, bottom: 20, left:20};
      const mapWidth = width - margin.left - margin.right;
      const mapHeight = height - margin.top - margin.bottom;
      const map = svg.append("g")
      .attr("transform","translate("+margin.left+","+margin.top+")");
      
    const displayMap = async function() {
      const us = await d3.json("/us-smaller.json");
      var states = topojson.feature(us, us.objects.states);    
      //var statesMesh = topojson.mesh(us, us.objects.states);  
  
      var projection = d3.geoAlbersUsa().fitSize([mapWidth, mapHeight], states);
      var path = d3.geoPath().projection(projection);
      console.log(us);
      console.log(states);
      //console.log(statesMesh);
      // console.log(path);

      var div = d3.select('body').append('div')   
      //.attr('class', 'tooltip')               
      .style('opacity', 50)
      
      //.text("california")
      //.style('positions', )
      var container = states.features[25]
      console.log(container)
      map.selectAll("path.state").data(states.features) // in map, add paths to each state
         .join("path")
         .attr("class", "state")
         .attr("note", d => d.id)  
         .attr("d", path)
        //  .on("mousedown", function clicked() {
        //   console.log(event.target.getAttribute('note'))
        //   if((event.target).getAttribute('note') == "06") {
        //     console.log("mouse down")
        //     //console.log(path)
        //     div.text("california");
        //   }
            
        //  }
         )
         ;
         
    
      //map.append("path").datum(statesMesh)
         //.attr("class","outline")
         //.attr("d", path);
    }
    
  
                                                                                                                                          
    displayMap();
    </script>
  
  </p>
  
  </body>
  </html>